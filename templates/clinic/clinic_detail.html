{% extends "_base.html" %}
{% load static %}

{% block page_title %}clinic_detail{% endblock %}

{% block content %}

<div class="container my-4">
  <div class="row g-3">

    <!-- ุณุชูู ุฑุงุณุช: ูพุฑููุงู ู ุงุทูุงุนุงุช -->
    <div class="col-lg-4" style="margin-top:80px;">
      
      <!-- ฺฉุงุฑุช ูพุฑููุงู -->
      <div class="card shadow-sm p-3 rounded-3 mb-3">
        <div class="d-flex align-items-center">
          <img src="{{ doc.image.url }}" alt="{{ doc.name }}" class="rounded-circle me-3" width="80" height="80">
          <div>
            <h5 class="mb-1">{{ tp.name }}</h5>
            <p class="text-muted small mb-1">{{ doc.specialty }}</p>
            <p class="text-muted small mb-0">ฺฉุฏ ูุธุงู ูพุฒุดฺฉ: {{ doc.medical_code }}</p>
          </div>
        </div>
        <hr>
        <div class="d-flex justify-content-between text-center">
          <div>โญ <span>{{ doc.rating }}</span></div>
          <div>๐ <span>%</span><br><small class="text-muted">ูพุดููุงุฏ ฺฉุงุฑุจุฑุงู</small></div>
          <div>๐ <span></span><br><small class="text-muted">ููุจุช ูููู</small></div>
        </div>
      </div>

      <!-- ุฏุฑุจุงุฑู ุฏฺฉุชุฑ -->
      <div class="card shadow-sm p-3 rounded-3 mb-3">
        <h6 class="mb-2">ุฏุฑุจุงุฑู {{ doc.name }}</h6>
        <p id="bio-text" class="text-muted small" style="max-height:80px; overflow:hidden;">
          {{ doctor.bio|default:"ุงุทูุงุนุงุช ุซุจุช ูุดุฏู ุงุณุช." }}
        </p>
        <button id="toggle-btn" class="btn btn-link p-0 small">ููุงุด ุจุดุชุฑ</button>
        <p style="text-align:right; font-weight:bold;">ุชุฎุตุตโูุง {{doc.name}}:</p>
        <div class="mb-2" style="text-align:right;">
          <span class="badge" style="background-color: transparent; color: #0d6efd; border: 1px solid #0d6efd;">
            {{ doc.specialty.name }}
          </span>
        </div>
      </div>

      <!-- ุขุฏุฑุณ ูุทุจ -->
      <div class="card shadow-sm p-3 rounded-3 mb-3">
        <h6 class="mb-2">ุขุฏุฑุณ ูุทุจ {{ doc.name }}</h6>
        <p style="text-align:right; font-weight:bold;">{{ doc.address }}</p>
      </div>

      <!-- ุฎุฏูุงุช -->
      <div class="card shadow-sm p-3 rounded-3 mb-3">
        <h6 class="mb-2">ุฎุฏูุงุช {{ doc.name }}</h6>
        <p>
          {% for s in doc.service.all %}
            {{ s.name }}{% if not forloop.last %}, {% endif %}
          {% empty %}
            ูฺ ุฎุฏูุช ุซุจุช ูุดุฏู
          {% endfor %}
        </p>
      </div>

      <!-- ุงูุชุงุฒ ู ุขูุงุฑ -->
   <div class="card shadow-sm p-3 rounded-3 mb-3">
  <div class="card-body">
    <div class="summary">
      <div class="rating-top">
        <div class="avg-score">
          <div class="score" id="avgScore">{{ avg_rating|default:"0.0" }}</div>
          <div class="count">{{ total_reviews|default:"0" }} ฺฉุงุฑุจุฑ</div>
        </div>
        <div class="stars-row" aria-hidden="true">
          {% for i in "12345" %}
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 .587l3.668 7.431L23.6 9.75l-5.4 5.26L19.8 24 12 19.897 4.2 24l1.6-8.99L.4 9.75l7.932-1.732z"/>
            </svg>
          {% endfor %}
        </div>
      </div>

      <div class="criteria-list" id="criteriaList">
        {% for crit in criteria %}
          <div class="crit">
            <div class="label">{{ crit.label }}</div>
            <div class="progress-wrap">
              <div class="progress">
                <i style="width:{{ crit.percent }}%"></i>
              </div>
            </div>
            <div class="value">{{ crit.value }}</div>
          </div>
        {% endfor %}
      </div>

      <div class="summary-stats d-flex justify-content-between mt-2">
        <div class="text-center">
          <div class="big">{{ recommend_percent|default:"0" }}%</div>
          <div>ูพุดููุงุฏ ฺฉุงุฑุจุฑุงู</div>
        </div>
        <div style="width:1px;background:#f0f2f7;height:42px;margin-inline:6px;border-radius:2px"></div>
        <div class="text-center">
          <div class="big">{{ avg_wait_label|default:"ฑต-ฐ ุฏููู" }}</div>
          <div>ูุงูฺฏู ุฒูุงู ุงูุชุธุงุฑ</div>
        </div>
      </div>

      <!-- ุฏฺฉูู ุขุจ ุงูุชุงุฒ ุฏู -->
      <div class="mt-3 text-center">
        <a href="{% url 'doctor-review' doc.id %}" 
           class="btn btn-primary" 
           style="padding:8px 20px; font-weight:500; border-radius:8px;">
          ุงูุชุงุฒ ุฏูุฏ
        </a>
      </div>

    </div>
  </div>
</div>

      <!-- FAQ -->
      <div class="faq-container mb-3">
        <h5 style="text-align:right; font-weight:bold; margin-bottom:15px;">ุณูุงูุงุช ูุชุฏุงูู ุฏุฑุจุงุฑู ุฏฺฉุชุฑ {{ doc.name }}</h5>
        {% for faq in faqs %}
        <div class="faq-item mb-2" style="border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); overflow:hidden;">
          <div class="faq-question" style="background:#f0f0f0; padding:12px 15px; cursor:pointer; font-weight:bold; text-align:right;">
            {{ faq.question }}
          </div>
          <div class="faq-answer" style="max-height:0; overflow:hidden; transition:max-height 0.4s ease, padding 0.4s ease; padding:0 15px; background:#fff; text-align:right;">
            <p style="margin:10px 0;">{{ faq.answer }}</p>
          </div>
        </div>
        {% endfor %}
      </div>

    </div>

    <!-- ุณุชูู ฺูพ: ููุจุชโุฏู ู ูุดุงูุฑู ุขููุงู -->
    <div class="col-lg-8" style="margin-top:80px;">

      <!-- ููุจุชโุฏู -->
      <div class="card shadow-sm p-3 mb-3 rounded-3">
        <h6 class="mb-3" style="font-weight:bold;">ููุจุชโุฏู ุงูุชุฑูุช ูุทุจ {{ doc.name }}</h6>
        <div class="border p-3 rounded-3">
          <p class="text-muted small mb-1">ุขุฏุฑุณ:<br>{{ doc.address }}</p>
          {% if doctor.available_appointments %}
            <!-- ููุงุด ููุจุชโูุง -->
          {% else %}
            <span class="badge bg-warning text-dark">ูุนูุงู ููุจุช ุชุนุฑู ูุดุฏู</span>
          {% endif %}
        </div>
      </div>

      <!-- ูุดุงูุฑู ุขููุงู -->
      <div class="card shadow-sm p-3 mb-3 rounded-3">
        <h6 class="mb-3">ูุดุงูุฑู ูพุฒุดฺฉ ุขููุงู {{ doc.name }}</h6>
        <div class="border p-3 rounded-3 mb-2">
          <div class="d-flex justify-content-between align-items-center">
            <span>๐ ููุจุช ูุดุงูุฑู ุชููู</span>
          </div>
          <hr>
          <div class="d-flex justify-content-between mt-2" style="text-align:right; font-size:14px;">
            <div>
              <span class="text-muted small">
                {% if first_available %}
                  ุงููู ููุจุช ุขุฒุงุฏ: {{ first_available.date }} ุณุงุนุช {{ first_available.time }}
                {% else %}
                  ุงููู ููุจุช: ูุนูุงู ุซุจุช ูุดุฏู
                {% endif %}
              </span>
              <div class="mt-2">
                <span style="display:inline-block; padding:6px 12px; border:1px solid #0d6efd; border-radius:8px; color:#0d6efd; background-color:transparent;">
                  ตฐฐ,ฐฐฐ ุชููุงู
                </span>
                <a href="javascript:void(0);" onclick="openDoctorModal({{ doctor_id }})" style="color:#0d6efd; text-decoration:underline; display:block; margin-top:5px;">
                  ูุดุงูุฑู ุชููู ุจฺฏุฑุฏ
                </a>
              </div>
            </div>
          </div>
        </div>

        <div class="border p-3 rounded-3" style="text-align:right;">
          <span style="display:block; font-weight:600;">๐ฌ ูุดุงูุฑู ูุชู</span>
          <hr style="margin:8px 0;">
          <p>ุงูฺฉุงู ุงุฑุณุงู ูพุงู ูุชู ู ุตูุช</p>
          <p>ุงูฺฉุงู ุงุฑุณุงู ูุงู</p>
          <p>ูพุงุณุฎฺฏู ูพุฒุดฺฉ ุฏุฑ ฺฉูุชุฑ ุงุฒ ฒด ุณุงุนุช</p>
          <span style="display:inline-block; padding:6px 12px; border:1px solid #0d6efd; border-radius:8px; color:#0d6efd; background-color:transparent;">
            ตฐฐ,ฐฐฐ ุชููุงู
          </span>
          <a href="{% url 'text_list' %}" style="color:#0d6efd; text-decoration:underline; display:block; margin-top:5px;">
            ูุดุงูุฑู ูุชู ุจฺฏุฑุฏ
          </a>
        </div>

      </div>

    </div>

  </div>
</div>


<footer style="width:100%; background:#fff; border-top:1px solid #ddd; padding:30px 20px; direction:rtl; box-sizing:border-box;">

  <!-- ุจุฎุด ุจุงูุง ููุชุฑ -->
  <div class="top-footer" style="
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
    gap:30px;
    width:100%;
    box-sizing:border-box;
  ">
    <!-- ุฎุฏูุงุช -->
    <div class="services">
      <h3 style="font-size:1.1rem; font-weight:bold; margin-bottom:10px;">ุฎุฏูุงุช ุฏฺฉุชุฑูุชู</h3>
      <ul style="list-style:none; padding:0; margin:0;">
        <li style="margin-bottom:6px;">
          <a href="#" style="color:#333; text-decoration:none;">ููุจุช ุฏู ูุทุจ</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:70px;">ุฏฺฉุชุฑุชู ฺฉููฺฉ</a>
        </li>
        <li style="margin-bottom:6px;">
          <a href="#" style="color:#333; text-decoration:none;">ูุดุงูุฑู ุชููู</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:90px;">ูุฑุงฺฉุฒ ุฏุฑูุงู</a>
        </li>
        <li style="margin-bottom:6px;">
          <a href="#" style="color:#333; text-decoration:none;">ูุดุงูุฑู ูุชู</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:90px;">ูุฌูู ุณูุงูุช</a>
        </li>
      </ul>
    </div>

    <!-- ุตูุญุงุช -->
    <div class="pages" style="text-align:right;">
      <h3 style="font-size:1.1rem; font-weight:bold; margin-bottom:10px;">ุตูุญุงุช ุฏฺฉุชุฑูุชู</h3>
      <ul style="list-style:none; padding:0; margin:0;">
        <li style="margin-bottom:6px;">
          <a href="#" style="color:#333; text-decoration:none;">ุฏุฑุจุงุฑู ูุง</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:60px;">ููุงูู ู ููุฑุฑุงุช</a>
        </li>
        <li style="margin-bottom:6px;">
          <a href="#" style="color:#333; text-decoration:none;">ุณูุงูุงุช ูุชุฏุงูู</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:20px;">ููุงูู ุซุจุช ูุธุฑ</a>
        </li>
        <li style="margin-bottom:6px;">
          <a href="#" style="color:#333; text-decoration:none;">ุซุจุช ูุงู ูพุฒุดฺฉุงู</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:20px;">ุชูุงุณ ุจุง ูุง</a>
        </li>
      </ul>
    </div>

    <!-- ุฏุฑ ฺฉูุงุฑ ุดูุง -->
    <div class="pages" style="text-align:right;">
      <h3 style="font-size:1.1rem; font-weight:bold; margin-bottom:10px;">ุฏุฑ ฺฉูุงุฑ ุดูุง</h3>
      <ul style="list-style:none; padding:0; margin:0;">
        <li style="margin-bottom:6px;"><a href="#" style="color:#333; text-decoration:none;">ุชุฎุตุต ูุง ูพุฒุดฺฉ</a></li>
        <li style="margin-bottom:6px;"><a href="#" style="color:#333; text-decoration:none;">ูููุนุช ูุง ุดุบู</a></li>
      </ul>
    </div>

    <!-- ุงูพูฺฉุดู -->
    <div class="pages" style="text-align:left;">
      <h2 style="font-size:1.1rem; font-weight:bold; margin-bottom:10px;">ุงูพูฺฉุดู ุฏฺฉุชุฑุชู ุฑุง ุฏุฑุงูุช ฺฉูุฏ</h2>
      <div class="app-buttons" style="margin-top:10px; display:flex; flex-direction:column; gap:10px; align-items:flex-start;">
        <a href="https://cafebazaar.ir/app/ir.hivatec.doctoreto" target="_blank" 
           style="padding:14px 0; font-size:1rem; color:#4CAF50; text-decoration:none; border:2px solid #4CAF50; border-radius:8px; background-color:transparent; text-align:center; min-width:200px; display:block; transition:0.3s;">
            ุฏุงูููุฏ ุงุฒ ฺฉุงูู ุจุงุฒุงุฑ
        </a>
        <a href="https://doctoreto.com/direct_download/doctoreto-4.7.3.apk" target="_blank" 
           style="padding:14px 0; font-size:1rem; color:#0070C9; text-decoration:none; border:2px solid #0070C9; border-radius:8px; background-color:transparent; text-align:center; min-width:200px; display:block; transition:0.3s;">
           ุฏุงูููุฏ ูุณุชูู ูุณุฎู ุงูุฏุฑูุฏ 
        </a>
      </div>
    </div>
  </div>

  <!-- ุฎุท ุฌุฏุงฺฉููุฏู -->
  <div style="width:100%; height:1px; background:#ddd; margin:30px 0;"></div>

  <!-- ุจุฎุด ูพุงู ููุชุฑ -->
  <div class="bottom-footer" style="display:flex; flex-wrap:wrap; justify-content:space-between; gap:20px; width:100%; box-sizing:border-box;">

    <!-- ุจููฺฉ ุชูุถุญ + ููฺฏู + ุฏฺฉูู ุจุดุชุฑ + ุชุตุงูุฑ -->
    <div class="description" style="text-align:right; max-width:400px;">
      <img src="{% static 'icons/doctoreto-logo.png' %}" alt="ููฺฏู" style="height:50px; margin-bottom:10px;">
      <p id="short-text" style="
          color:#555; 
          font-size:0.9rem; 
          line-height:1.4;
          display:-webkit-box;
          -webkit-line-clamp:3;
          -webkit-box-orient:vertical;
          overflow:hidden;
          text-overflow:ellipsis;
      ">
        ุฏฺฉุชุฑุชู ุณุงุฏูโุชุฑู ุฑุงู ููุจุชโ ุฏู ุงูุชุฑูุช ู ูุดุงูุฑู ุขููุงู ูพุฒุดฺฉุงู ุงุฑุงู ุงุณุช...
      </p>
      <button id="read-more" style="background:none; border:none; color:#0070C9; cursor:pointer; font-size:0.9rem; padding:0; margin-top:5px;">ุจุดุชุฑ</button>

      <div class="icons-row" style="display:flex; gap:15px; margin-top:15px; flex-wrap:wrap; justify-content:flex-start;">
        <img src="{% static 'images/enamad.png' %}" alt="ููุงุฏ 1" style="height:50px;">
        <img src="{% static 'images/samandehi.png' %}" alt="ููุงุฏ 2" style="height:50px;">
        <img src="{% static 'images/etehadie-logo.png' %}" alt="ููุงุฏ 3" style="height:50px;">
        <img src="{% static 'images/saman-kish-logo.png' %}" alt="ููุงุฏ 4" style="height:50px;">
        <img src="{% static 'images/mellat.png' %}" alt="ููุงุฏ 5" style="height:50px;">
      </div>
    </div>
     <div class="social" style="text-align:right;">
  <h4 style="margin-bottom:10px;">ุจุง ูุง ุฏุฑ ุงุฑุชุจุงุท ุจุงุดุฏ</h4>
   <p>ุงูู:</p>
  <!-- ุงูู ุจุง ุขฺฉูู -->
  <div style="display:flex; align-items:center; gap:8px;">
    <img src="{% static 'icons/email.png' %}" alt="ุงูู" style="height:24px;">
    <a href="mailto:info@doctoreto.com" style="color:#0070C9; text-decoration:none;">info@doctoreto.com</a>
  </div>
</div>
<div class="social" style="text-align:right;">
  <h4 style="margin-bottom:10px;">ุดุจฺฉู ูุง ุงุฌุชูุงุน</h4>
  <!-- ุขฺฉููโูุง ุจุง ุชุตูุฑ -->
  <a href="https://www.instagram.com" target="_blank" style="margin-left:10px;">
    <img src="{% static 'icons/instagram--1364.png' %}" alt="ุงูุณุชุงฺฏุฑุงู" style="width:30px; height:30px;">
  </a>
  <a href="https://www.telegram.org" target="_blank" style="margin-left:10px;">
    <img src="{% static 'icons/telegram--1410.png' %}" alt="ุชูฺฏุฑุงู" style="width:30px; height:30px;">
  </a>
  <a href="https://www.linkedin.com" target="_blank" style="margin-left:10px;">
    <img src="{% static 'icons/linkedin--1372.png' %}" alt="ููฺฉุฏู" style="width:30px; height:30px;">
  </a>
  <a href="https://www.twitter.com" target="_blank" style="margin-left:10px;">
    <img src="{% static 'icons/images.png' %}" alt="ุงูพุงุฑุงุช" style="width:30px; height:30px;">
  </a>
</div>

 

  </div>
    <div style="width:100%; height:1px; background:#ddd; margin:30px 0;"></div>
   <div class='text' style="text-align:center;">
    <p>ฺฉููโ ุญููู ุงู ูุจุณุงุช ูุชุนูู ุจู ุดุฑฺฉุช ุฏุงูุด ุจูุงู ููโุขูุฑ ุงุทูุงุนุงุช ุงูุฑุฑุถุง ุฎุณุฑูุงู  ุงุณุช.</p>
   </div> 
      <div style="width:100%; height:1px; background:#ddd; margin:30px 0;"></div>
       <!-- ุฎุฏูุงุช -->
    <div class="services">
      <h3 style="font-size:1.1rem; font-weight:bold; margin-bottom:10px;">ุดูุฑูุง ุฏฺฉุชุฑุชู</h3>
      <ul style="list-style:none; padding:0; margin:0;">
        <li style="margin-bottom:6px;">
          <a href="#" style="color:#333; text-decoration:none;">ุฏฺฉุชุฑุชู ุชูุฑุงู</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:120px;">ุฏฺฉุชุฑุชู ุงุตููุงู</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:120px;">ุฏฺฉุชุฑุชู ุดุฑุงุฒ</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:120px;">ุฏฺฉุชุฑุชู ุจูุดูุฑ</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:120px;">ุฏฺฉุชุฑุชู ูุดูุฏ</a>
        </li>
        <li style="margin-bottom:6px;">
          <a href="#" style="color:#333; text-decoration:none;">ุฏฺฉุชุฑุชู ุจูุฏุฑุนุจุงุณ</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:90px;">ุฏฺฉุชุฑุชู ุงููุงุฒ</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:140px;">ุฏฺฉุชุฑุชู ฺฉุฑุฌ</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:120px;">ุฏฺฉุชุฑุชู ฺฉุฑูุงู</a>
          <a href="#" style="color:#333; text-decoration:none; margin-right:130px;">ุฏฺฉุชุฑุชู ุชุจุฑุฒ</a>

           
        </li>
        
      </ul>
    </div>

</footer>
<!-- ุงุณฺฉุฑูพุช FAQ ู bio -->
<script>
document.querySelectorAll('.faq-question').forEach(question => {
  question.addEventListener('click', () => {
    const answer = question.nextElementSibling;
    if(answer.style.maxHeight && answer.style.maxHeight !== "0px"){
      answer.style.maxHeight = "0px";
      answer.style.paddingTop = "0";
      answer.style.paddingBottom = "0";
    } else {
      answer.style.maxHeight = answer.scrollHeight + "px";
      answer.style.paddingTop = "10px";
      answer.style.paddingBottom = "10px";
    }
  });
});

const bioText = document.getElementById("bio-text");
const toggleBtn = document.getElementById("toggle-btn");
let expanded = false;
toggleBtn.addEventListener("click", function() {
  expanded = !expanded;
  if (expanded) {
    bioText.style.maxHeight = "none";
    toggleBtn.innerText = "ููุงุด ฺฉูุชุฑ";
  } else {
    bioText.style.maxHeight = "80px";
    toggleBtn.innerText = "ููุงุด ุจุดุชุฑ";
  }
});
</script>

{% endblock %}
